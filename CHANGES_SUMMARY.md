# –†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å Issues

## –ü—Ä–æ–±–ª–µ–º–∞
Issues –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∏–Ω–≥–µ—Å—Ç–∏–∏ –ø–∞–¥–∞–µ—Ç –¥–æ —ç—Ç–∞–ø–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–ª–µ–º (–ª–∏–±–æ —É–±–∏–≤–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –Ω–µ—Ö–≤–∞—Ç–∫–∏ –ø–∞–º—è—Ç–∏, –ª–∏–±–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π).

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `ingest_data.py`

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã DEBUG-—Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ:
  - –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
  - –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π
  - –°–æ–∑–¥–∞–Ω–∏–µ —Ö–∏—Ç–æ–≤
  - –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
  - **–ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ issues** (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —ç—Ç–∞–ø)
  - –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–≥–æ—Ä—Ç

- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
  - –î–µ—Ç–∞–ª—å–Ω—ã–π traceback –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏ –≤ stdout, –∏ –≤ stderr
  - –û—à–∏–±–∫–∏ –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –≤ docker logs

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º—É—Å–æ—Ä–∞ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏

### 2. –°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ `check_ingestion_status`

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –°–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–æ (—Å–µ—Å—Å–∏–∏, —Ö–∏—Ç—ã, –º–µ—Ç—Ä–∏–∫–∏)
- –°–∫–æ–ª—å–∫–æ issues —Å–æ–∑–¥–∞–Ω–æ
- –ù–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å –∏–Ω–≥–µ—Å—Ç–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
docker-compose exec web python manage.py check_ingestion_status
```

### 3. –°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–¥–µ–ª—å–Ω–æ `run_analysis_only`

–ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑ issues –Ω–∞ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –±–µ–∑ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
docker-compose exec web python manage.py run_analysis_only --product-version "v1.0 (2022)" --clear-existing
```

### 4. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `DIAGNOSTICS.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –∏ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º
- `CHANGES_SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã)

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:**
   ```bash
   docker-compose exec web python manage.py check_ingestion_status
   ```

2. **–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –Ω–æ issues = 0, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∞–Ω–∞–ª–∏–∑:**
   ```bash
   docker-compose exec web python manage.py run_analysis_only --product-version "v1.0 (2022)" --clear-existing
   docker-compose exec web python manage.py run_analysis_only --product-version "v2.0 (2024)" --clear-existing
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/issues/
   - Issues –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω–≥–µ—Å—Ç–∏—é —Å –Ω–æ–≤—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

```bash
docker-compose exec web python manage.py ingest_data \
    --visits "2022_yandex_metrika_visits.parquet" \
    --hits "2022_yandex_metrika_hits.parquet" \
    --product-version "v1.0 (2022)" \
    --year 2022 \
    --clear
```

–¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –≤—ã —É–≤–∏–¥–∏—Ç–µ —Ç–æ—á–Ω–æ, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ—Ü–µ—Å—Å –ø–∞–¥–∞–µ—Ç.

## –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ö–æ–º–∞–Ω–¥–∞ `check_ingestion_status` –ø–æ–∫–∞–∂–µ—Ç:

```
üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏: v1.0 (2022) (ID: 1)
  1. VisitSession: 10000 —Å–µ—Å—Å–∏–π
  2. PageHit: 50000 —Ö–∏—Ç–æ–≤
  3. PageMetrics: 150 —Å—Ç—Ä–∞–Ω–∏—Ü
  4. UXIssue: 0 –ø—Ä–æ–±–ª–µ–º        ‚Üê –ü–†–û–ë–õ–ï–ú–ê!
  5. UserCohort: 0 –∫–æ–≥–æ—Ä—Ç
  6. DailyStat: 0 –¥–Ω–µ–π

üìç –≠—Ç–∞–ø –∏–Ω–≥–µ—Å—Ç–∏–∏:
  ‚ö†Ô∏è  –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –Ω–æ –ù–ï–¢ ISSUES - –∏–Ω–≥–µ—Å—Ç–∏—è —É–ø–∞–ª–∞ –Ω–∞ —ç—Ç–∞–ø–µ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–ª–µ–º!
  üî¥ –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –∞–Ω–∞–ª–∏–∑ issues –Ω–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω!
```

## –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É

1. **–í–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã**: –¢–µ–ø–µ—Ä—å –≤–∏–¥–Ω–æ —Ç–æ—á–Ω–æ, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –ø–∞–¥–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å
2. **–ì–∏–±–∫–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ, –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
3. **–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏**: –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –Ω–µ –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
4. **–≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏**: –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ø–∞–º—è—Ç—å

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
2. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –Ω–æ issues –Ω–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `run_analysis_only`
3. –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –ø–∞–¥–∞–µ—Ç —Å "Killed" - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–º—è—Ç–∏ –≤ docker-compose.yml
4. –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π traceback –≤ –ª–æ–≥–∞—Ö

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —ç—Ç–∞–ø–∞—Ö
- –û—à–∏–±–∫–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –æ–±–∞ –ø–æ—Ç–æ–∫–∞ (stdout –∏ stderr) –¥–ª—è –ª—É—á—à–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤ docker logs
- –î–æ–±–∞–≤–ª–µ–Ω —Å–±–æ—Ä –º—É—Å–æ—Ä–∞ (gc.collect()) –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
- –ö–æ–º–∞–Ω–¥–∞ `run_analysis_only` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Ö –≤ —Ñ–æ—Ä–º–∞—Ç, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

